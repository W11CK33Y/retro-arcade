<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üêç Snake | Retro Arcade</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');

body {
  font-family: 'Press Start 2P', monospace;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 100vh;
  margin: 0;
  text-align: center;
  overflow: hidden;
  background: radial-gradient(circle at center, #1a0028 0%, #080010 80%);
  color: #d78aff;
}

h1 {
  font-size: 1.4rem;
  text-shadow: 0 0 5px #d78aff, 0 0 15px #a84aff;
  margin-bottom: 5px;
}

#scoreboard {
  margin-bottom: 10px;
  font-size: 0.7rem;
  display: flex;
  justify-content: space-around;
  width: 240px;
  text-shadow: 0 0 4px #d78aff;
}

canvas {
  border: 3px solid #d78aff;
  box-shadow: 0 0 10px #a84aff, 0 0 20px #8a2be2;
  background: #12001d;
  touch-action: none;
  max-width: 95%;
  height: auto;
}

button {
  margin-bottom: 12px;
  background: transparent;
  border: 2px solid #d78aff;
  color: #d78aff;
  padding: 0.7rem 1.5rem;
  font-size: 0.8rem;
  font-family: inherit;
  text-shadow: 0 0 4px #d78aff;
  cursor: pointer;
  transition: all 0.2s ease;
}

button:hover {
  background: #d78aff;
  color: #1a0028;
  box-shadow: 0 0 10px #d78aff, 0 0 20px #8a2be2;
  transform: scale(1.05);
}

.scanlines {
  position: absolute;
  top:0;
  left:0;
  width:100%;
  height:100%;
  pointer-events: none;
  z-index: 10;
}
</style>
</head>
<body>
<div class="scanlines" id="scanlines"></div>
<h1>üêç Snake</h1>

<div id="scoreboard">
  <div>Score: <span id="score">0</span></div>
  <div>High: <span id="highscore">0</span></div>
</div>

<button id="themeBtn">üé® Change Theme</button>
<canvas id="snake" width="400" height="400"></canvas>

<script>
const canvas = document.getElementById("snake");
const ctx = canvas.getContext("2d");

// Game settings
const box = 20;
let snake = [{x: 9*box, y: 10*box}];
let direction = null;
let targetDirection = null; // For smooth direction changes
let food = {x: Math.floor(Math.random()*20)*box, y: Math.floor(Math.random()*20)*box};
let score = 0;
let highscore = localStorage.getItem("snakeHighscore") || 0;
document.getElementById("highscore").textContent = highscore;

// Themes
const themes = [
  { bodyBg:"radial-gradient(circle at center, #1a0028 0%, #080010 80%)",
    text:"#d78aff", glow:"#a84aff",
    canvasBorder:"#d78aff", canvasBg:"#12001d",
    snakeColor:"#d78aff", foodColor:"#a84aff" },
  { bodyBg:"radial-gradient(circle at center, #001a00 0%, #000800 80%)",
    text:"#00ff88", glow:"#00ffaa",
    canvasBorder:"#00ff88", canvasBg:"#001100",
    snakeColor:"#00ff88", foodColor:"#00ffaa" },
  { bodyBg:"radial-gradient(circle at center, #2a001a 0%, #100008 80%)",
    text:"#ff00aa", glow:"#ff66cc",
    canvasBorder:"#ff00aa", canvasBg:"#1a0011",
    snakeColor:"#ff00aa", foodColor:"#ff66cc" }
];
let currentTheme = parseInt(localStorage.getItem("retroTheme")) || 0;

// Apply theme
function applyTheme(theme){
  document.body.style.background = theme.bodyBg;
  document.body.style.color = theme.text;
  document.querySelector("h1").style.textShadow = `0 0 5px ${theme.text}, 0 0 15px ${theme.glow}`;
  canvas.style.border = `3px solid ${theme.canvasBorder}`;
  canvas.style.background = theme.canvasBg;
}

// Theme button
document.getElementById("themeBtn").addEventListener("click", ()=>{
  currentTheme = (currentTheme+1)%themes.length;
  localStorage.setItem("retroTheme", currentTheme);
  applyTheme(themes[currentTheme]);
});

// Draw functions
function drawSquare(x,y,color){
  ctx.fillStyle = color;
  ctx.shadowColor = color;
  ctx.shadowBlur = 10;
  ctx.fillRect(x,y,box,box);
  ctx.shadowBlur = 0;
}
function drawSnake(){
  snake.forEach(s=>drawSquare(s.x,s.y,themes[currentTheme].snakeColor));
}
function drawFood(){
  drawSquare(food.x,food.y,themes[currentTheme].foodColor);
}

// Controls
document.addEventListener("keydown", e=>{
  if(e.key==="ArrowLeft" && direction!="RIGHT") targetDirection="LEFT";
  else if(e.key==="ArrowUp" && direction!="DOWN") targetDirection="UP";
  else if(e.key==="ArrowRight" && direction!="LEFT") targetDirection="RIGHT";
  else if(e.key==="ArrowDown" && direction!="UP") targetDirection="DOWN";
});

// Mobile swipe support
let touchStartX=null, touchStartY=null;
canvas.addEventListener("touchstart", e=>{
  const t=e.touches[0]; touchStartX=t.clientX; touchStartY=t.clientY;
}, {passive:false});
canvas.addEventListener("touchend", e=>{
  const t=e.changedTouches[0];
  const dx=t.clientX-touchStartX;
  const dy=t.clientY-touchStartY;
  if(Math.abs(dx)>Math.abs(dy)){
    if(dx>0 && direction!="LEFT") targetDirection="RIGHT";
    else if(dx<0 && direction!="RIGHT") targetDirection="LEFT";
  }else{
    if(dy>0 && direction!="UP") targetDirection="DOWN";
    else if(dy<0 && direction!="DOWN") targetDirection="UP";
  }
}, {passive:false});

// Game loop
function update(){
  if(targetDirection) direction=targetDirection;

  let head = {x: snake[0].x, y: snake[0].y};
  if(direction==="LEFT") head.x -= box;
  if(direction==="RIGHT") head.x += box;
  if(direction==="UP") head.y -= box;
  if(direction==="DOWN") head.y += box;

  // Wrap around
  if(head.x>=canvas.width) head.x=0;
  if(head.x<0) head.x=canvas.width-box;
  if(head.y>=canvas.height) head.y=0;
  if(head.y<0) head.y=canvas.height-box;

  // Collision with self
  for(let i=0;i<snake.length;i++){
    if(head.x===snake[i].x && head.y===snake[i].y){
      alert("Game Over!");
      if(score>highscore){localStorage.setItem("snakeHighscore",score);}
      document.location.reload();
    }
  }

  snake.unshift(head);

  // Eat food
  if(head.x===food.x && head.y===food.y){
    score++;
    document.getElementById("score").textContent = score;
    food = {x: Math.floor(Math.random()*20)*box, y: Math.floor(Math.random()*20)*box};
  }else snake.pop();

  // Draw with trail
  ctx.fillStyle = themes[currentTheme].canvasBg + "90"; // semi-transparent for trail
  ctx.fillRect(0,0,canvas.width,canvas.height);

  drawSnake();
  drawFood();
}

applyTheme(themes[currentTheme]);
setInterval(update,120);
</script>
</body>
</html>
